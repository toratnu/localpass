<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LocalPass - パスワード管理</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- ロック画面 -->
    <div class="container" id="lock-screen">
        <div class="logo">
            <h1>LocalPass</h1>
            <p>お使いのブラウザで安全にパスワードを管理します</p>
        </div>

        <div class="collapsible" id="usage-info">
            <div class="collapsible-header">
                📋 初めてお使いの方へ / 注意事項
            </div>
            <div class="collapsible-content">
                <h4>使い方</h4>
                <ol>
                    <li><strong>マスターパスワード設定:</strong> 初回利用時、推測されにくい強力なマスターパスワードを設定してください。</li>
                    <li><strong>ロック解除:</strong> 設定したマスターパスワードでロックを解除し、保存したパスワードにアクセスします。</li>
                </ol>
                <h4><strong>⚠️ 重要事項</strong></h4>
                <ul>
                    <li><strong>マスターパスワードは絶対に忘れないでください。</strong>忘れると、保存したデータは二度と復元できません。</li>
                    <li>データはブラウザ内にのみ保存され、サーバーには送信されません。</li>
                    <li>重要なデータは別途バックアップを取ることを推奨します。</li>
                </ul>
            </div>
        </div>

        <div class="input-group">
            <input type="password" class="input-field" id="master-password-input" placeholder="マスターパスワードを入力">
            <div class="password-strength" id="password-strength">
                <div class="strength-bar">
                    <div class="strength-progress" id="password-strength-bar"></div>
                </div>
                <div class="strength-text" id="password-strength-text"></div>
            </div>
        </div>

        <div id="unlock-error-message" class="error-message" style="display: none;"></div>

        <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
            <button class="btn btn-primary" id="unlock-button">
                🔑 ロック解除
            </button>
            <button class="btn btn-danger" id="destroy-data-button" style="display: none;">
                🗑️ 全データ削除
            </button>
        </div>
    </div>

    <!-- メイン画面 -->
    <div class="container" id="main-screen" style="display: none;">
        <div class="header">
            <h1>パスワード一覧</h1>
            <div class="header-controls">
                <div class="search-container">
                    <input type="search" class="search-input" id="search-input" placeholder="サービス名で検索">
                </div>
                <button class="btn btn-primary" id="add-password-button">
                    ➕ 新規追加
                </button>
                <button class="btn btn-secondary" id="change-master-password-button">
                    🔄 変更
                </button>
                <button class="btn btn-secondary" id="lock-button">
                    🔒 ロック
                </button>
            </div>
        </div>

        <div class="collapsible" id="usage-guide">
            <div class="collapsible-header">
                💡 使い方ガイド
            </div>
            <div class="collapsible-content">
                <ul>
                    <li><strong>新規追加:</strong> 右上の「新規追加」ボタンからパスワードを登録します。</li>
                    <li><strong>検索:</strong> 検索ボックスにサービス名を入力すると、一覧を絞り込めます。</li>
                    <li><strong>表示/非表示 (👁️):</strong> パスワードを一時的に表示・非表示します。</li>
                    <li><strong>コピー (📋):</strong> パスワードをクリップボードにコピーします。</li>
                    <li><strong>削除 (🗑️):</strong> 登録したパスワードを削除します。</li>
                </ul>
            </div>
        </div>

        <div id="password-list">
            <!-- パスワード項目がここに追加される -->
        </div>
    </div>

    <!-- パスワード追加モーダル -->
    <div class="modal" id="add-password-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>パスワードを新規追加</h2>
            </div>
            <div class="input-group">
                <input type="text" class="input-field" id="service-name-input" placeholder="サービス名 (例: Google)">
            </div>
            <div class="input-group">
                <input type="text" class="input-field" id="username-input" placeholder="ユーザーID/メールアドレス (任意)">
            </div>
            <div class="input-group">
                <input type="password" class="input-field" id="password-input" placeholder="パスワード">
            </div>
            <div class="modal-buttons">
                <button class="btn btn-secondary" id="cancel-button">❌ キャンセル</button>
                <button class="btn btn-primary" id="save-button">💾 保存</button>
            </div>
        </div>
    </div>

    <!-- マスターパスワード変更モーダル -->
    <div class="modal" id="change-master-password-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>マスターパスワードの変更</h2>
            </div>
            <div class="input-group">
                <input type="password" class="input-field" id="current-master-password-input" placeholder="現在のマスターパスワード">
            </div>
            <div class="input-group">
                <input type="password" class="input-field" id="new-master-password-input" placeholder="新しいマスターパスワード">
                <div class="password-strength" id="new-password-strength">
                    <div class="strength-bar">
                        <div class="strength-progress" id="new-password-strength-bar"></div>
                    </div>
                    <div class="strength-text" id="new-password-strength-text"></div>
                </div>
            </div>
            <div class="input-group">
                <input type="password" class="input-field" id="confirm-new-master-password-input" placeholder="新しいマスターパスワード（確認）">
            </div>
            <p style="color: var(--text-muted); font-size: 0.9rem; margin-bottom: 1rem;">
                注意: マスターパスワードを変更すると、全てのデータが新しいパスワードで再暗号化されます。
            </p>
            <div class="modal-buttons">
                <button class="btn btn-secondary" id="cancel-change-master-password-button">❌ キャンセル</button>
                <button class="btn btn-primary" id="save-new-master-password-button">💾 保存</button>
            </div>
        </div>
    </div>

    <script src="js/lib/crypto.js"></script>
    <script src="js/main.js"></script>
</body>
</html>